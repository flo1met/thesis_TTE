setwd("C:/Users/Florian/Documents/GitHub/thesis_TTE/data")
read.csv("trial_example_seq.csv")
df <- read.csv("trial_example_seq.csv")
?glm
model <- glm(outcome ~ assigned_treatment + trialnr + I(trialnr^2) + fup + I(fup^2) + catvarA + catvarB + catvarC + nvarA + nvarB + nvarC,
data = df,
weights = df$IPW,
family = binomial(link = "logit"))
summary(model)
View(df)
df$catvarA <- factor(df$catvarA)
df$catvarB <- factor(df$catvarB)
df$catvarC <- factor(df$catvarC)
model <- glm(outcome ~ assigned_treatment + trialnr + I(trialnr^2) + fup + I(fup^2) + catvarA + catvarB + catvarC + nvarA + nvarB + nvarC,
data = df,
weights = df$IPW,
family = binomial(link = "logit"))
summary(model)
library(TrialEmulation)
# Prepare the example data
data("trial_example")
# Set columns to factors as necessary
trial_example$catvarA <- as.factor(trial_example$catvarA)
trial_example$catvarB <- as.factor(trial_example$catvarB)
trial_example$catvarC <- as.factor(trial_example$catvarC)
getwd()
getwd()
t1 <- Sys.time()
result <- initiators(
data = trial_example,
id = "id",
period = "period",
eligible = "eligible",
treatment = "treatment",
estimand_type = "ITT",
outcome = "outcome",
model_var = "assigned_treatment",
outcome_cov = c("catvarA", "catvarB", "catvarC", "nvarA", "nvarB", "nvarC"),
use_censor_weights = FALSE,
save_weight_models = TRUE,
data_dir = "C:/Users/Florian/Documents/Utrecht University/05_thesis/BIOSTAT-07 - Confidence Intervals in Emulated Target Trials"
)
t2 <- Sys.time()
t2-t1
summary(result$model)
View(result)
?initiators
test <- data_preparation(data = trial_example,
id = "id",
period = "period",
eligible = "eligible",
treatment = "treatment",
estimand_type = "ITT",
outcome = "outcome",
model_var = "assigned_treatment",
outcome_cov = c("catvarA", "catvarB", "catvarC", "nvarA", "nvarB", "nvarC"),
use_censor_weights = FALSE,
analysis_weights = "asis",
save_weight_models = TRUE
)
test <- data_preparation(data = trial_example,
id = "id",
period = "period",
eligible = "eligible",
treatment = "treatment",
estimand_type = "ITT",
outcome = "outcome",
model_var = "assigned_treatment",
outcome_cov = c("catvarA", "catvarB", "catvarC", "nvarA", "nvarB", "nvarC"),
use_censor_weights = FALSE,
analysis_weights = "asis",
save_weight_models = TRUE,
data_dir = "C:/Users/Florian/Documents/Utrecht University/05_thesis/BIOSTAT-07 - Confidence Intervals in Emulated Target Trials"
)
View(test)
View(test$data)
library(tidyverse)
df_test <- test$data %>%
sort(c(id, trial_period))
df_test <- test$data %>%
sort(c("id", "trial_period"))
?sort
?arrange
df_test <- test$data %>%
arrange(id, trial_period)
View(test)
View(df_test)
?TrialEmulation::trial_msm
out <- trial_msm(test, estimand_type = "ITT",
outcome = "outcome",
model_var = "assigned_treatment")
View(test)
View(out)
out <- trial_msm(test, estimand_type = "ITT",
outcome = "outcome",
model_var = "assigned_treatment",
use_sample_weights = FALSE)
?initiators
View(test)
summary(test)
result <- initiators(
data = trial_example,
id = "id",
period = "period",
eligible = "eligible",
treatment = "treatment",
estimand_type = "ITT",
outcome = "outcome",
model_var = "assigned_treatment",
outcome_cov = c("catvarA", "catvarB", "catvarC", "nvarA", "nvarB", "nvarC"),
use_censor_weights = FALSE,
save_weight_models = TRUE,
data_dir = "C:/Users/Florian/Documents/Utrecht University/05_thesis/BIOSTAT-07 - Confidence Intervals in Emulated Target Trials",
switch_n_cov = "followup_time + I(followup_time^2)",
switch_d_cov = "catvarA + catvarB + catvarC + nvarA + nvarB + nvarC + followup_time + I(followup_time^2)"
)
t1 <- Sys.time()
result <- initiators(
data = trial_example,
id = "id",
period = "period",
eligible = "eligible",
treatment = "treatment",
estimand_type = "ITT",
outcome = "outcome",
model_var = "assigned_treatment",
outcome_cov = c("catvarA", "catvarB", "catvarC", "nvarA", "nvarB", "nvarC"),
use_censor_weights = FALSE,
save_weight_models = TRUE,
data_dir = "C:/Users/Florian/Documents/Utrecht University/05_thesis/BIOSTAT-07 - Confidence Intervals in Emulated Target Trials",
switch_n_cov = "period + I(period^2)",
switch_d_cov = "catvarA + catvarB + catvarC + nvarA + nvarB + nvarC + period + I(period^2)"
)
t1 <- Sys.time()
result <- initiators(
data = trial_example,
id = "id",
period = "period",
eligible = "eligible",
treatment = "treatment",
estimand_type = "ITT",
outcome = "outcome",
model_var = "assigned_treatment",
outcome_cov = c("catvarA", "catvarB", "catvarC", "nvarA", "nvarB", "nvarC"),
use_censor_weights = FALSE,
save_weight_models = TRUE,
data_dir = "C:/Users/Florian/Documents/Utrecht University/05_thesis/BIOSTAT-07 - Confidence Intervals in Emulated Target Trials",
switch_n_cov = "period + I(period^2)",
switch_d_cov = "catvarA + catvarB + catvarC + nvarA + nvarB + nvarC + period + I(period^2)"
)
t2 <- Sys.time()
t2-t1
View(result)
result <- initiators(
data = trial_example,
id = "id",
period = "period",
eligible = "eligible",
treatment = "treatment",
estimand_type = "ITT",
outcome = "outcome",
model_var = "assigned_treatment",
outcome_cov = c("catvarA", "catvarB", "catvarC", "nvarA", "nvarB", "nvarC"),
use_censor_weights = FALSE,
save_weight_models = TRUE,
data_dir = "C:/Users/Florian/Documents/Utrecht University/05_thesis/BIOSTAT-07 - Confidence Intervals in Emulated Target Trials",
switch_n_cov = "period + I(period^2)",
switch_d_cov = "catvarA + catvarB + catvarC + nvarA + nvarB + nvarC + period + I(period^2)",
pool_cense = "none"
)
t1 <- Sys.time()
result <- initiators(
data = trial_example,
id = "id",
period = "period",
eligible = "eligible",
treatment = "treatment",
estimand_type = "PP",
outcome = "outcome",
model_var = "assigned_treatment",
outcome_cov = c("catvarA", "catvarB", "catvarC", "nvarA", "nvarB", "nvarC"),
use_censor_weights = FALSE,
save_weight_models = TRUE,
data_dir = "C:/Users/Florian/Documents/Utrecht University/05_thesis/BIOSTAT-07 - Confidence Intervals in Emulated Target Trials",
switch_n_cov = "period + I(period^2)",
switch_d_cov = "catvarA + catvarB + catvarC + nvarA + nvarB + nvarC + period + I(period^2)",
pool_cense = "none"
)
t2 <- Sys.time()
t2-t1
